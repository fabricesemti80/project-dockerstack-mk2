# ZSH Configuration for {{ ansible_hostname }}
# Generated by Ansible - Homelab Server Setup

# Path to your oh-my-zsh installation.
export ZSH="$HOME/.oh-my-zsh"

# Set name of the theme to load
ZSH_THEME="powerlevel10k/powerlevel10k"

# Powerlevel10k instant prompt (load after theme is set)
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

HYPHEN_INSENSITIVE="true"
zstyle ':omz:update' mode auto
zstyle ':omz:update' frequency 13
COMPLETION_WAITING_DOTS="true"

plugins=(
    git
    docker
    docker-compose
    systemd
    sudo
    history
    history-substring-search
    colored-man-pages
    command-not-found
    zsh-autosuggestions
    zsh-syntax-highlighting
)

source $ZSH/oh-my-zsh.sh

export EDITOR='vim'
export LANG=en_US.UTF-8

alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
alias ..='cd ..'
alias ...='cd ../..'

alias dps='docker ps'
alias dpa='docker ps -a'
alias di='docker images'
alias dlog='docker logs'
alias dexec='docker exec -it'

alias syslog='sudo journalctl -f'
alias ports='sudo netstat -tuln'
alias df='df -h'
alias du='du -sh'
alias free='free -h'
alias top='htop'

alias lvm-status='sudo /usr/local/bin/extend_lvm.sh status'
alias lvm-extend='sudo /usr/local/bin/extend_lvm.sh'

alias gs='git status'
alias ga='git add'
alias gc='git commit'
alias gp='git push'
alias gl='git log --oneline'

function mkcd() {
    mkdir -p "$1" && cd "$1"
}

function sysinfo() {
    echo "=== System Information ==="
    echo "Hostname: $(hostname)"
    echo "Uptime: $(uptime -p)"
    echo "Memory: $(free -h | grep Mem | awk '{print $3"/"$2}')"
    echo "Disk /: $(df -h / | tail -1 | awk '{print $3"/"$2" ("$5" used)"}')"
    if [ -d /data ]; then
        echo "Disk /data: $(df -h /data 2>/dev/null | tail -1 | awk '{print $3"/"$2" ("$5" used)"}' || echo 'Not mounted')"
    fi
    echo "=========================="
}

if [[ $- == *i* ]] && [[ -z "$TMUX" ]]; then
    echo "Welcome to {{ ansible_hostname }}!"
    echo "Type 'sysinfo' for system status"
fi

[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
